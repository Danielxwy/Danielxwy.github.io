(()=>{var oe=r=>typeof r=="object"&&r!=null&&r.nodeType===1,ne=(r,u)=>(!u||r!=="hidden")&&r!=="visible"&&r!=="clip",Z=(r,u)=>{if(r.clientHeight<r.scrollHeight||r.clientWidth<r.scrollWidth){let v=getComputedStyle(r,null);return ne(v.overflowY,u)||ne(v.overflowX,u)||(T=>{let p=(h=>{if(!h.ownerDocument||!h.ownerDocument.defaultView)return null;try{return h.ownerDocument.defaultView.frameElement}catch(L){return null}})(T);return!!p&&(p.clientHeight<T.scrollHeight||p.clientWidth<T.scrollWidth)})(r)}return!1},$=(r,u,v,T,p,h,L,b)=>h<r&&L>u||h>r&&L<u?0:h<=r&&b<=v||L>=u&&b>=v?h-r-T:L>u&&b<v||h<r&&b>v?L-u+p:0,re=r=>{let u=r.parentElement;return u==null?r.getRootNode().host||null:u},_=(r,u)=>{var v,T,p,h;if(typeof document>"u")return[];let{scrollMode:L,block:b,inline:C,boundary:N,skipOverflowHiddenElements:U}=u,X=typeof N=="function"?N:d=>d!==N;if(!oe(r))throw new TypeError("Invalid target");let O=document.scrollingElement||document.documentElement,D=[],y=r;for(;oe(y)&&X(y);){if(y=re(y),y===O){D.push(y);break}y!=null&&y===document.body&&Z(y)&&!Z(document.documentElement)||y!=null&&Z(y,U)&&D.push(y)}let H=(T=(v=window.visualViewport)==null?void 0:v.width)!=null?T:innerWidth,x=(h=(p=window.visualViewport)==null?void 0:p.height)!=null?h:innerHeight,{scrollX:B,scrollY:k}=window,{height:S,width:I,top:e,right:t,bottom:o,left:n}=r.getBoundingClientRect(),{top:l,right:f,bottom:a,left:g}=(d=>{let i=window.getComputedStyle(d);return{top:parseFloat(i.scrollMarginTop)||0,right:parseFloat(i.scrollMarginRight)||0,bottom:parseFloat(i.scrollMarginBottom)||0,left:parseFloat(i.scrollMarginLeft)||0}})(r),w=b==="start"||b==="nearest"?e-l:b==="end"?o+a:e+S/2-l+a,s=C==="center"?n+I/2-g+f:C==="end"?t+f:n-g,c=[];for(let d=0;d<D.length;d++){let i=D[d],{height:m,width:E,top:W,right:G,bottom:J,left:q}=i.getBoundingClientRect();if(L==="if-needed"&&e>=0&&n>=0&&o<=x&&t<=H&&e>=W&&o<=J&&n>=q&&t<=G)return c;let F=getComputedStyle(i),R=parseInt(F.borderLeftWidth,10),j=parseInt(F.borderTopWidth,10),Y=parseInt(F.borderRightWidth,10),P=parseInt(F.borderBottomWidth,10),A=0,M=0,z="offsetWidth"in i?i.offsetWidth-i.clientWidth-R-Y:0,V="offsetHeight"in i?i.offsetHeight-i.clientHeight-j-P:0,K="offsetWidth"in i?i.offsetWidth===0?0:E/i.offsetWidth:0,Q="offsetHeight"in i?i.offsetHeight===0?0:m/i.offsetHeight:0;if(O===i)A=b==="start"?w:b==="end"?w-x:b==="nearest"?$(k,k+x,x,j,P,k+w,k+w+S,S):w-x/2,M=C==="start"?s:C==="center"?s-H/2:C==="end"?s-H:$(B,B+H,H,R,Y,B+s,B+s+I,I),A=Math.max(0,A+k),M=Math.max(0,M+B);else{A=b==="start"?w-W-j:b==="end"?w-J+P+V:b==="nearest"?$(W,J,m,j,P+V,w,w+S,S):w-(W+m/2)+V/2,M=C==="start"?s-q-R:C==="center"?s-(q+E/2)+z/2:C==="end"?s-G+Y+z:$(q,G,E,R,Y+z,s,s+I,I);let{scrollLeft:ee,scrollTop:te}=i;A=Q===0?0:Math.max(0,Math.min(te+A/Q,i.scrollHeight-m/Q+V)),M=K===0?0:Math.max(0,Math.min(ee+M/K,i.scrollWidth-E/K+z)),w+=te-A,s+=ee-M}c.push({el:i,top:A,left:M})}return c};var ie=r=>r===!1?{block:"end",inline:"nearest"}:(u=>u===Object(u)&&Object.keys(u).length!==0)(r)?r:{block:"start",inline:"nearest"};function se(r,u){if(!r.isConnected||!(p=>{let h=p;for(;h&&h.parentNode;){if(h.parentNode===document)return!0;h=h.parentNode instanceof ShadowRoot?h.parentNode.host:h.parentNode}return!1})(r))return;let v=(p=>{let h=window.getComputedStyle(p);return{top:parseFloat(h.scrollMarginTop)||0,right:parseFloat(h.scrollMarginRight)||0,bottom:parseFloat(h.scrollMarginBottom)||0,left:parseFloat(h.scrollMarginLeft)||0}})(r);if((p=>typeof p=="object"&&typeof p.behavior=="function")(u))return u.behavior(_(r,u));let T=typeof u=="boolean"||u==null?void 0:u.behavior;for(let{el:p,top:h,left:L}of _(r,ie(u))){let b=h-v.top+v.bottom,C=L-v.left+v.right;p.scroll({top:b,left:C,behavior:T})}}window.requestIdleCallback=window.requestIdleCallback||function(r){let u=Date.now();return setTimeout(function(){r({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-u))}})},1)};window.cancelIdleCallback=window.cancelIdleCallback||function(r){clearTimeout(r)};(()=>{let r=(e,t)=>{if(t){let o=t.innerText;navigator.clipboard.writeText(o);let n=e.innerHTML;e.innerHTML='<i class="fa fa-check-circle"></i>&nbsp;\u6210\u529F~',setTimeout(()=>{e.innerHTML=n},3e3)}},u=async()=>{var t;let e=(((t=window.kr)==null?void 0:t.siteRoot)||"/")+"config.json";return await fetch(e).then(o=>o.json())},v=()=>{let e=!1,t=()=>{window.requestAnimationFrame(()=>{window.scrollY>200?e||(document.body.classList.add("scroll-down"),e=!0):e&&(document.body.classList.remove("scroll-down"),e=!1)})};document.getElementById("gotop-box").addEventListener("click",o=>(window.scrollTo({top:0,behavior:"smooth"}),!1)),t(),window.addEventListener("scroll",t)},T=()=>{let e=document.getElementById("kratos-menu-wrap").cloneNode(!0);e.setAttribute("id","offcanvas-menu"),e.querySelectorAll("ul").forEach(o=>{o.removeAttribute("id")});let t=document.getElementById("kratos-nav-toggle-wrapper");document.getElementById("kratos-nav-toggle").addEventListener("click",()=>{t.classList.contains("toon")?(t.classList.remove("toon"),e.classList.remove("show")):(t.classList.add("toon"),e.classList.add("show"))}),e.addEventListener("click",o=>{o.target.tagName.toLowerCase()==="a"&&o.target.getAttribute("href")&&(t.classList.remove("toon"),e.classList.remove("show"))}),window.addEventListener("resize",o=>{window.innerWidth>768&&t.classList.contains("toon")&&(t.classList.remove("toon"),e.classList.remove("show"))}),document.getElementById("kratos-page").prepend(e)},p=()=>{document.querySelectorAll(".collapse-box-control").forEach(e=>{var t;(t=e.querySelector(".collapse-box-header"))==null||t.addEventListener("click",o=>{e.classList.toggle("active")})})},h=e=>{if(e.enable){let t=document.getElementsByClassName("kratos-page-content");t.length>0&&new Viewer(t[0],{filter:o=>!(typeof o.closest=="function"&&o.closest(".kr-linklist")!==null)})}},L,b=e=>{L=e.template.replaceAll("$NEWLINE","\n").replaceAll("$AUTHOR",document.querySelector("meta[name='author']").getAttribute("content")).replaceAll("$TITLE",document.title).replaceAll("$LINK",window.location.href)},C=e=>{e.enable&&(document.body.oncopy=t=>{if(L){let o=window.getSelection().toString();o.length>e.threshold&&(t.preventDefault(),t.clipboardData&&t.clipboardData.setData("text/plain",o+L))}})},N=(e,t=!0)=>{let o,n=e/1e3,l=Math.floor(n/60/60/24),f=Math.floor(n/60/60-24*l),a=Math.floor(n/60-24*60*l-60*f),g=Math.floor(n-24*60*60*l-60*60*f-60*a),w=l.toString(),s=f.toString(),c=a.toString(),d=g.toString();return t?(w&&w.length===1&&(w="0"+w),s&&s.length===1&&(s="0"+s),c&&c.length===1&&(c="0"+c),d&&d.length===1&&(d="0"+d),o=w+"\u5929"+s+"\u5C0F\u65F6"+c+"\u5206"+d+"\u79D2"):l<540?l<60?o=w+"\u5929":o=Math.floor(l/30).toString()+"\u4E2A\u6708":o=Math.floor(l/365).toString()+"\u5E74",o},U=e=>{let t=new Date(e.since),o=document.getElementById("kr-since");setInterval(()=>{o.innerText=N(Date.now()-t)},1e3)},X=()=>{document.querySelectorAll("figure.highlight").forEach((o,n)=>{let l=o.getElementsByTagName("table")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr")[0].getElementsByClassName("code")[0],f=document.createElement("button");f.className="copy-code",f.innerHTML='<i class="fa fa-copy"></i>&nbsp;\u590D\u5236',f.onclick=r.bind(null,f,l),o.appendChild(f)}),document.querySelectorAll("pre:has(code)").forEach((o,n)=>{let l=o.querySelector("code"),f=document.createElement("button");f.className="copy-code",f.innerHTML='<i class="fa fa-copy"></i>&nbsp;\u590D\u5236',f.onclick=r.bind(null,f,l),o.appendChild(f)})},O=()=>{let e=typeof window<"u",t=e&&!("onscroll"in window)||typeof navigator<"u"&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),o=e&&"IntersectionObserver"in window,n=document.querySelector(".kr-comments.lazy-load"),l=()=>{window.loadCommentsEventHandler&&window.cancelIdleCallback(window.loadCommentsEventHandler),typeof window.loadComments=="function"&&(window.loadCommentsEventHandler=window.requestIdleCallback(window.loadComments),window.loadComments=null)};if(e&&!t&&o&&n){let f=new IntersectionObserver(a=>{a[0].isIntersecting&&(l(),f.disconnect())},{threshold:0});f.observe(n)}else l();window.addEventListener("pjax:before",()=>{window.loadComments&&(window.loadComments=null)},{once:!0})},D=()=>{let e=document.getElementById("expire-alert");if(e){let t=e.querySelector("time"),o=new Date(parseInt(t.getAttribute("datetime"))),l=Date.now()-o,f=e.getAttribute("data-after-days");l>parseInt(f)*24*3600*1e3&&(t.innerText=N(l,!1),e.classList.remove("hidden"))}},y=(e,t)=>{let o=0;return function(){let n=this,l=arguments;clearTimeout(o),o=setTimeout(function(){e.apply(n,l)},t||0)}},H=()=>{let e=document.getElementById("krw-toc"),t=()=>{let o=e.getElementsByClassName("toc-item"),n=[];try{Array.from(o).forEach(s=>{let c=s.querySelector(".toc-link"),d=decodeURI(c.getAttribute("href"));if(d.substring(0,1)!="#")throw new Error("TOC \u5C0F\u6807\u9898\u94FE\u63A5\u65E0\u6548\uFF0C\u683C\u5F0F\u65E0\u9650");let i=document.getElementById(d.substring(1));if(!i)throw new Error("TOC \u5C0F\u6807\u9898\u94FE\u63A5\u65E0\u6548\uFF0C\u672A\u627E\u5230\u76F8\u5173\u5F15\u7528");i.setAttribute("data-toc-id",n.length),n.push({at:i,el:s})})}catch(s){console.log("\u9519\u8BEF\uFF1A",s.message),Array.from(o).forEach(c=>{c.classList.add("show")});return}let l=-1,f=s=>{if(l!==s){if(l!==-1&&n[l]){n[l].el.classList.remove("active"),n[l].el.classList.remove("show");let c=n[l].el;for(;!c.classList.contains("toc");)c.classList.contains("toc-item")&&c.classList.remove("show"),c=c.parentNode}if(s!==-1&&n[s]){n[s].el.classList.add("active"),n[s].el.classList.add("show");let c=n[s].el;for(;!c.classList.contains("toc");)c.classList.contains("toc-item")&&c.classList.add("show"),c=c.parentNode;setTimeout(()=>{var i;let d=(i=n[s])==null?void 0:i.el;d&&se(d,{behavior:"smooth",block:"nearest",inline:"nearest",boundary:e})},300)}l=s}};if("IntersectionObserver"in window){let s=y((d,i)=>{i===window.scrollY?window.requestAnimationFrame(()=>{f(d)}):s(d,window.scrollY)},100),c=new IntersectionObserver(d=>{let i=null;d.forEach(m=>{let E=Number.parseInt(m.target.getAttribute("data-toc-id"),10);m.rootBounds&&(!m.isIntersecting&&m.boundingClientRect.top<=m.rootBounds.top?i=E:m.isIntersecting&&m.boundingClientRect.bottom<m.rootBounds.top+m.rootBounds.height/2&&m.intersectionRatio===1&&(i=E-1))}),i!==null&&s(i,window.scrollY)},{rootMargin:"-62px 0px 0px 0px",threshold:1});n.forEach(d=>{c.observe(d.at)}),window.addEventListener("pjax:before",()=>{c.disconnect(),n.length=0},{once:!0})}else{let s=()=>{n.forEach(m=>{m.h=m.at.getBoundingClientRect().top+window.scrollY-61})};s();let c=()=>{let m;!Number.isInteger(l)||l<0||l>n.length-1?m=0:m=l;let E=window.scrollY;if(E>=n[m].h)if(E>=n[n.length-1].h)m=n.length-1;else for(;E>=n[m+1].h;)m++;else for(;E<n[m].h&&(m--,!(m<0)););return m},d=y(()=>{window.requestAnimationFrame(()=>{f(c())})},100),i=y(()=>{s(),window.requestAnimationFrame(()=>{f(c())})},100);window.addEventListener("resize",i),window.addEventListener("scroll",d),window.addEventListener("pjax:before",()=>{window.removeEventListener("resize",i),window.removeEventListener("scroll",d),n.length=0},{once:!0})}let a=document.getElementsByClassName("toc-progress-bar")[0],g=document.querySelector(".kratos-page-content"),w=()=>{if(g){let s=window.scrollY||document.documentElement.scrollTop,c=g.clientHeight,d=document.documentElement.clientHeight,i=g.offsetTop,m=c>d?c-d:document.documentElement.scrollHeight-d,E=Math.max(0,Math.min((s-i)/m,1)),W=Math.round(E*100);a.style.width=(E*100).toString()+"%",a.setAttribute("aria-valuenow",W)}};window.addEventListener("scroll",()=>{window.requestAnimationFrame(w)}),w()};e&&(e.offsetParent!==null?t():"IntersectionObserver"in window&&new IntersectionObserver(t,{threshold:0,once:!0}).observe(e))},x=e=>{if(!e.enable)return;let t=window.innerHeight,o=!1,n=()=>{window.requestAnimationFrame(()=>{t<window.scrollY?o||(document.body.classList.add("nav-up"),o=!0):t>window.scrollY&&o&&(document.body.classList.remove("nav-up"),o=!1),t=window.scrollY})};window.addEventListener("wheel",n)},B=()=>{document.querySelectorAll(".kratos-entry-thumb-img").forEach(a=>{a.addEventListener("mouseenter",function(){this.style.transform="scale(1.1)"}),a.addEventListener("mouseleave",function(){this.style.transform="scale(1)"}),a.addEventListener("mousedown",function(){this.style.transform="scale(1)"})});let t=document.querySelectorAll(".lazy-image"),o=document.querySelectorAll(".thumbhash-placeholder"),n={};o.forEach(a=>{n[a.dataset.src]||(n[a.dataset.src]={holders:[],str:a.dataset.thumbhash}),n[a.dataset.src].holders.push(a)});let l=a=>{let g=n[a.dataset.src];if(g){let w=Uint8Array.from(atob(g.str),s=>s.charCodeAt(0));g.holders.forEach(s=>{s.src=thumbHashToDataURL(w)})}},f=a=>{let g=n[a.dataset.src];g&&a.addEventListener("load",function(){g.holders.forEach(w=>{w.classList.add("hide"),setTimeout(()=>{w.style.display="none"},600)})}),a.classList.remove("lazy-image"),a.src=a.dataset.src};if("IntersectionObserver"in window){let a=new IntersectionObserver((g,w)=>{g.forEach(s=>{if(s.isIntersecting){let c=s.target;f(c),w.unobserve(c)}})});t.forEach(g=>{l(g),a.observe(g)})}else t.forEach(a=>{l(a),f(a)})},k=()=>{let e=[H,X,p,O,D,B];for(let t of e)try{t()}catch(o){console.error("Error: ".concat(o)),o.stack&&console.error(o.stack)}},S=e=>{let t=[()=>b(e.copyrightNoticeForCopy),()=>h(e.viewerjs)];for(let o of t)try{o()}catch(n){console.error("Error: ".concat(n)),n.stack&&console.error(n.stack)}},I=()=>{document.removeEventListener("DOMContentLoaded",I,!1),window.removeEventListener("load",I,!1),u().then(t=>{let o=[()=>C(t.copyrightNoticeForCopy),()=>U(t.uptime),()=>x(t.topNavScrollToggle),()=>S(t)];for(let n of o)try{n()}catch(l){console.error("Error: ".concat(l)),l.stack&&console.error(l.stack)}window.addEventListener("pjax:complete",()=>{S(t)})}).catch(t=>{console.error("Load config failed: ".concat(t))});let e=[v,T,k];for(let t of e)try{t()}catch(o){console.error("Error: ".concat(o)),o.stack&&console.error(o.stack)}window.addEventListener("pjax:complete",()=>{k()})};document.readyState==="complete"?setTimeout(I):(document.addEventListener("DOMContentLoaded",I,!1),window.addEventListener("load",I,!1))})();})();
